{% extends 'base.html' %}

{% load staticfiles %}

{% block title %}TripShare{% endblock %}

{% block body_block %}

{% if user.is_authenticated %}
<div class="page-header">

    <h1 style="text-align: center" >Hello, {{ user.username }}!</h1>
    {% else %}
    <h1 style="text-align: center" >Welcome to TripShare!</h1>
    {% endif %}

</div>

    <div class="row placeholders">
        <div class="container">

            <div class="index_filters panel panel-primary">
                        <div class="filters_header panel-heading">Show Filters</div>
                        <div class="hiddencontent panel-body">
                            <p><label for="id_source">Source:</label><input id="id_source" /></p>
                            <p><label for="id_destination">Destination:</label><input id="id_destination" /></p>
                            <p><label for="sortby">Destination:</label>
                            <div class="dropdown">
                                <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-expanded="true">
                                    Dropdown
                                    <span class="caret"></span>
                                </button>
                                <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
                                    <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Action</a></li>
                                    <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Another action</a></li>
                                    <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Something else here</a></li>
                                    <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Separated link</a></li>
                                </ul>
                            </div>
                            </p>
                        </div>
                    </div>
            <div class="row">

            {% for tr in trips %}

            <div class="col-xs-12 col-sm-10 col-md-12">
                <div class="thumbnail">
                    <div class="caption">
                        <h2><b>{{ tr }}</b></h2>
                        <p><b>Created by:</b>
                            {% if user.is_authenticated %}
                            <a href="{% url 'view_profile' tr.creator %}"> {{ tr.creator }}</a>
                            {% else %}
                            {{ tr.creator }}
                            {% endif %}
                        </p>
                        <p><b>Trip Date: </b> {{ tr.tripdate }}</p>
                        <p>
                            {% csrf_token %}

                            {% if user.is_authenticated %}
                                {% ifnotequal user tr.creator %}
                                    {% if tr.id in requests %}
                                        <button data-user="{{user.id}}" data-trip="{{tr.id}}" id="{{tr.id}}" class="btn btn-primary join" type="button" disabled>Join</button>

                                    {% else %}
                                        <button data-user="{{user.id}}" data-trip="{{tr.id}}" id="{{tr.id}}" class="btn btn-primary join" type="button">Join</button>
                                    {% endif %}
                            {% else %}
                            <button class="btn btn-primary disabled" type="button">Can't join own trip!</button>

                            {% endifnotequal %}
                            {% endif %}
                            <button class="btn btn-default detailsbtn" type="button">View Details</button>
                        </p>

                        <div class="table hiddencontent">
                            <p><b>Description:</b> {{ tr.desc }}</p>
                            <table border="0" style="width:100%">
                                {%  if tr.cost != Null %}
                                <tr>
                                    <td>Cost:</td>
                                    <td>{{ tr.cost }}</td>
                                </tr>
                                {% endif %}
                                <tr>
                                    <td>Passengers: </td>
                                    <td>{{ tr.pass_num }}</td>
                                </tr>
                                <tr>
                                    <td>Date Posted</td>
                                    <td>{{ tr.dateposted }}</td>
                                </tr>
                            </table>

                        </div>
                    </div>
                </div>
            </div>

            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}
